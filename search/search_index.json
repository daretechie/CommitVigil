{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"CommitVigil: The Accountability Specialist \ud83d\udee1\ufe0f","text":"<p>\"I provide 'Accountability as a Service.' My agent predicts when a team member is likely to fail before the deadline and intervenes with the right behavioral tone to ensure delivery.\"</p>"},{"location":"#the-problem","title":"\ud83c\udd98 The Problem","text":"<p>In modern distributed teams, the \"Slack Stall\" is the #1 drain on project velocity. Project Managers are overwhelmed by vague promises like \"I'll get to it soon,\" which are often forgotten, leading to missed sprints and \"bad guy\" escalations.</p>"},{"location":"#the-solution","title":"\u2705 The Solution","text":"<p>CommitVigil is a standalone, agentic service designed to monitor and enforce professional commitments. Every commitment passes through a 5-Stage Reasoning Pipeline:</p> <ol> <li>Extraction: Automatically parses Slack threads or Git commits to identify {who, what, when}.</li> <li>Excuse Analysis: Categorizes sentiment (Legitimate vs. Deflection vs. Burnout).</li> <li>Risk Scoring: Quantifies failure probability based on historical reliability.</li> <li>Safety Overwatch: Audits interventions for ethics, tone drift, and HR compliance.</li> <li>Professional Reporting: Generates high-impact \"Integrity Audits\" for management reviews.</li> </ol>"},{"location":"#architecture-at-a-glance","title":"\ud83c\udfd7\ufe0f Architecture at a Glance","text":"<p>CommitVigil is built on a Decoupled Event-Driven Architecture: - FastAPI Entrypoint: High-speed ingestion for Slack and Git webhooks. - Redis &amp; ARQ: Distributed background processing for high-volume orchestration. - The Brain: Multi-agent LLM reasoning loop. - PostgreSQL: Industrial-grade persistence with atomic row-locking for score integrity. - Pluggable Connectors: Source-agnostic design ready for Jira, MS Teams, Linear, and custom CRM integrations.</p>"},{"location":"#sales-intelligence-roi","title":"\ud83d\udcb0 Sales Intelligence (ROI)","text":"<p>Calculate the projected savings for a prospective client. <pre><code>curl -X 'GET' \\\n  -H 'X-API-Key: YOUR_API_KEY' \\\n  'http://localhost:8000/api/v1/sales/roi-calculator?team_size=50&amp;currency=USD'\n</code></pre></p>"},{"location":"ORIENTATION/","title":"Repository Orientation: CommitVigil AI \ud83d\udee1\ufe0f","text":"<p>Welcome to CommitVigil. This repository has been rigorously cleaned and structured to ensure maximum clarity and maintainability.</p>"},{"location":"ORIENTATION/#architectural-invariants","title":"\ud83c\udfd7\ufe0f Architectural Invariants","text":""},{"location":"ORIENTATION/#1-separation-of-reasoning","title":"1. Separation of Reasoning","text":"<p>All AI logic resides in <code>src/agents/</code>.  - The Brain (<code>brain.py</code>): Orchestrates the 5-stage pipeline. - The Safety Supervisor (<code>safety.py</code>): Acts as a semantic firewall. - The Context Scout (<code>scout.py</code>): Senses industry/departmental context.</p>"},{"location":"ORIENTATION/#2-dto-persistence-stability","title":"2. DTO &amp; Persistence Stability","text":"<p>We use SQLModel in <code>src/schemas/agents.py</code>. These classes serve as both database models and API data transfer objects. Do not duplicate schemas unless absolutely necessary for versioning.</p>"},{"location":"ORIENTATION/#3-asynchronous-backbone","title":"3. Asynchronous Backbone","text":"<p>All long-running evaluations are offloaded to ARQ workers (<code>src/worker.py</code>). The API should never block on an LLM call.</p>"},{"location":"ORIENTATION/#key-directories","title":"\ud83d\udcc2 Key Directories","text":"Directory Purpose <code>src/core/</code> Low-level cross-cutting concerns (DB, Config, Logging). <code>infra/</code> Configuration templates (K8s, Prometheus). <code>docs/adr/</code> Architectural Decision Records. Read these before suggesting major changes. <code>tests/</code> Use <code>pytest</code> for all verification. Adversarial tests are critical for safety."},{"location":"ORIENTATION/#quick-setup","title":"\ud83e\uddea Quick Setup","text":"<ol> <li>Install Dependencies: <code>poetry install</code></li> <li>Environment: Copy <code>.env.example</code> to <code>.env</code> and provide your <code>OPENAI_API_KEY</code>.</li> <li>Run Services: <code>docker-compose up -d</code></li> <li>Run Sample: <code>./scripts/demo.sh</code></li> </ol>"},{"location":"ORIENTATION/#maintenance-rules","title":"\ud83e\uddf9 Maintenance Rules","text":"<ul> <li>Zero Tolerance for Junk: Do not commit exploratory scripts or <code>.db</code> files to the root.</li> <li>Test-Driven Refactor: Always run the full suite (<code>pytest</code>) before submitting PRs.</li> <li>Self-Documenting Fixes: If a bug is architectural, record it as an ADR.</li> </ul>"},{"location":"adr/ADR-001-Safety-Supervisor/","title":"ADR-001: Safety Supervisor (Semantic Firewall) Design","text":""},{"location":"adr/ADR-001-Safety-Supervisor/#status","title":"Status","text":"<p>Accepted</p>"},{"location":"adr/ADR-001-Safety-Supervisor/#context","title":"Context","text":"<p>CommitVigil AI generates autonomous interventions (messages to users). In enterprise environments (Healthcare, Finance, Tech R&amp;D), these messages can accidentally violate HR policies, leak PII, or give non-compliant advice. A single agent (Brain) might fail to perceive these boundaries due to \"jailbreak\" attempts or model drift.</p>"},{"location":"adr/ADR-001-Safety-Supervisor/#decision","title":"Decision","text":"<p>We implement a Safety Supervisor (Semantic Firewall) as a mandatory secondary reasoning layer.</p>"},{"location":"adr/ADR-001-Safety-Supervisor/#key-principles","title":"Key Principles:","text":"<ol> <li>Separation of Concerns: The 'Brain' focuses on accountability; the 'Supervisor' focuses on compliance.</li> <li>Industry-Specific Rule Injection: Rules are dynamically fetched from the database based on the user's <code>industry</code> and <code>department</code>.</li> <li>Hard Blocking: High-risk violations (e.g., PII leak, legal liability) trigger an immediate <code>HARD_BLOCK</code> which prevents any message from being sent and escalates to a human manager.</li> <li>Autonomous Onboarding: If a message belongs to an unknown context, the Supervisor generates temporary rules but flags the entire interaction as \"Unverified\" (Stabilization Layer).</li> </ol>"},{"location":"adr/ADR-001-Safety-Supervisor/#consequences","title":"Consequences","text":"<ul> <li>Latency: Adds ~500ms-1s per evaluation cycle.</li> <li>Safety: Significantly reduces the risk of AI-generated liability.</li> <li>Complexity: Requires a well-indexed database and a Redis cache for rule lookup to remain performance-neutral under load.</li> </ul>"},{"location":"adr/ADR-002-Sales-Intelligence-Layer/","title":"ADR-002: Sales Intelligence &amp; Prospecting Layer","text":"<p>Date: 2026-01-30 Status: Accepted Context: As CommitVigil evolves into an enterprise GTM tool, there is a need for a layer that simulates findinds for demos and calculates ROI without contaminating the core, forensic accountability engine.</p> <p>Decision: We will implement a dedicated <code>Sales Intelligence</code> layer consisting of the <code>ProspectingScout</code> agent and a specialized <code>sales</code> API router.</p> <p>Rationale: 1. Separation of Concerns: Core agents (<code>brain.py</code>, <code>safety.py</code>) focus on real-world transaction analysis. The <code>ProspectingScout</code> focuses on simulation and synthetic scenario generation. 2. Performance: Sales-specific endpoints are treated as \"high-intensity\" but lower frequency, allowing for independent rate-limiting and scaling tiers. 3. Multi-Currency Support: By normalizing ROI math to USD in the core <code>reporting.py</code> but and converting at the edge in <code>sales.py</code>, we maintain architectural simplicity while serving global markets.</p> <p>Consequences: - All Sales-related logic must reside in <code>src.api.v1.sales</code> or <code>src.agents.prospector</code>. - Core reporting utilities in <code>reporting.py</code> are extended to support sales outputs (e.g., Executive Briefs) but remain usable by the standard audit flow. - Increased token usage for sales demos is managed via a dedicated 10 req/min rate limit.</p>"},{"location":"guides/feedback_loop/","title":"Manager Guide: Human-In-The-Loop (HITL) Feedback Loop","text":""},{"location":"guides/feedback_loop/#overview","title":"Overview","text":"<p>CommitGuard AI's \"Safety Supervisor\" monitors all communications. Sometimes, the AI might be too strict (e.g., blocking a legitimate technical discussion) or too lenient. The Feedback Loop allows managers to override AI decisions, which in turn trains the underlying model.</p>"},{"location":"guides/feedback_loop/#how-it-works","title":"How it Works","text":"<ol> <li>When an intervention is triggered (Block or Correction), it is logged with a unique <code>intervention_id</code>.</li> <li>A manager reviews the audit trail via the Dashboard or API.</li> <li>The manager submits feedback (Accept, Reject, or Modify).</li> </ol>"},{"location":"guides/feedback_loop/#api-integration","title":"API Integration","text":"<p>To submit feedback via the API, use the <code>POST /api/v1/safety/feedback</code> endpoint.</p>"},{"location":"guides/feedback_loop/#example-request","title":"Example Request","text":"<pre><code>{\n  \"intervention_id\": \"uuid-1234-5678\",\n  \"user_id\": \"dev_rockstar\",\n  \"manager_id\": \"manager_alice\",\n  \"action_taken\": \"accepted\",\n  \"final_message_sent\": \"I understand you're busy, let's sync on Monday.\",\n  \"comments\": \"Correction was perfect, helped maintain professional tone.\"\n}\n</code></pre>"},{"location":"guides/feedback_loop/#dashboard-usage","title":"Dashboard Usage","text":"<ol> <li>Navigate to the Safety Audit Console.</li> <li>Filter for \"Pending Review\" or \"Recent Interventions\".</li> <li>Click Accept or Edit &amp; Send.</li> </ol>"},{"location":"guides/feedback_loop/#impact-on-reliability-score","title":"Impact on Reliability Score","text":"<p>Rejecting an AI failure detection might restore a user's reliability score if the \"failure\" was incorrectly flagged by the agent.</p>"},{"location":"guides/feedback_loop/#continuous-learning","title":"Continuous Learning","text":"<p>The AI recalibrates its <code>min_confidence_threshold</code> based on the Manager Acceptance Rate. If managers frequently reject interventions in a specific department, the \"Supervisor\" becomes more conservative in that context.</p>"},{"location":"guides/gitops/","title":"GitOps Accountability Guide \ud83d\udee0\ufe0f","text":"<p>In the engineering world, commitments aren't just made in Slack; they are made in Source Code.</p>"},{"location":"guides/gitops/#the-problem","title":"\ud83d\udd34 The Problem","text":"<p>Technical debt often accumulates because of \"soft promises\" made in code comments or commit messages: - \"TODO: Refactor this DB connector.\" - \"I'll fix this auth bug in the next PR.\" - \"Temporary hack, will clean up tonight.\"</p> <p>These promises \"vanish\" because no project management tool monitors them.</p>"},{"location":"guides/gitops/#the-solution-commitvigil-gitops","title":"\ud83d\udfe2 The Solution: CommitVigil GitOps","text":"<p>CommitVigil monitors your repository at the source level.</p>"},{"location":"guides/gitops/#1-extraction-from-commits","title":"1. Extraction from Commits","text":"<p>If a commit message contains a promise (Who/What/When), the CommitmentExtractor identifies it as a formal obligation. </p> <p>[!NOTE] The extractor uses a <code>commitment_found</code> flag to identify messages with NO clear task, preventing the agent from hallucinating promises.</p> <pre><code>POST /api/v1/ingest/git\nHeaders: X-API-Key: YOUR_API_KEY\nBody:\n{\n  \"author_email\": \"dev@company.com\",\n  \"message\": \"Fixing CSS. I promise to refactor the login logic by Friday.\"\n}\n</code></pre>"},{"location":"guides/gitops/#2-fulfillment-analysis-slippage","title":"2. Fulfillment Analysis (Slippage)","text":"<p>The SlippageAnalyst looks at the subsequent PR.  *   The Check: Did the promised refactor actually happen? *   The Result: If the code doesn't match the promise, the agent flags \"Shadow Debt\" and alerts the team.</p>"},{"location":"guides/gitops/#3-truth-gap-detection","title":"3. Truth Gap Detection","text":"<p>When you provide a check-in via Slack, CommitVigil cross-references it with your recent Git activity. *   User: \"I'm almost done refactoring.\" *   Git: 0 lines changed in 48 hours. *   Agent: \"I noticed no code changes. Is there a blocker I can help with?\" (Tone: Supportive but firm).</p>"},{"location":"guides/gitops/#4-identity-mapping-crucial-step","title":"4. Identity Mapping (Crucial Step)","text":"<p>To link your Git commits to your Slack profile, you must map your email to your user ID:</p> <pre><code>curl -X POST \\\n  -H 'X-API-Key: YOUR_API_KEY' \\\n  'http://localhost:8000/api/v1/users/config/git?user_id=Daretechie&amp;email=your-email@example.com'\n</code></pre> <p>Once mapped, <code>identity_matched</code> will return <code>true</code> in ingest responses, and the agent will know exactly who to ping in Slack.</p> <p>[!TIP] Use the same <code>user_id</code> across both Slack and Git mapping to ensure a unified accountability profile.</p>"},{"location":"guides/integrations/","title":"Integration &amp; Pluggability Guide \ud83d\udd0c","text":"<p>CommitVigil is designed with a \"Source-Agnostic\" core. While Slack and Git are the primary supported platforms, the system can be easily extended to any tool that supports Webhooks or REST APIs.</p>"},{"location":"guides/integrations/#1-inbound-ingestion-incoming-data","title":"1. Inbound Ingestion (Incoming Data)","text":"<p>The system can ingest commitments from any source via the <code>/api/v1/ingest/raw</code> endpoint.</p>"},{"location":"guides/integrations/#examples","title":"Examples:","text":"<ul> <li>Jira: Set up a Jira Webhook that triggers on \"Issue Commented\" and send the comment body to CommitVigil.</li> <li>Linear: Sync Linear comments to track engineering promises made in task descriptions.</li> <li>Calendly: Map calendar bookings to commitments (e.g., \"I will have the demo ready by the meeting time\").</li> </ul>"},{"location":"guides/integrations/#how-to-implement","title":"How to Implement:","text":"<p>Simply call the endpoint with the raw text and a <code>user_id</code>: <pre><code>curl -X POST \"$API_URL/api/v1/ingest/raw?user_id=john_dev&amp;raw_text=I promise to fix the DB by Friday\"\n</code></pre></p>"},{"location":"guides/integrations/#2-outbound-notifications-interventions","title":"2. Outbound Notifications (Interventions)","text":"<p>Currently, CommitVigil uses the <code>SlackConnector</code> for follow-ups. However, the architecture is modular.</p>"},{"location":"guides/integrations/#adding-a-new-tool-eg-ms-teams-or-discord","title":"Adding a New Tool (e.g., MS Teams or Discord):","text":"<ol> <li>Create a Connector: Add a new file in <code>src/core/</code> (e.g., <code>teams.py</code>) following the <code>SlackConnector</code> pattern.</li> <li>Update the Worker: In <code>src/worker.py</code>, update the <code>send_follow_up</code> function to route messages to your new connector:</li> </ol> <pre><code># src/worker.py\nasync def send_follow_up(user_id: str, message: str, slack_id: str | None = None, teams_webhook: str | None = None):\n    if teams_webhook:\n        await TeamsConnector.send(message, teams_webhook)\n    else:\n        await SlackConnector.send_notification(message, slack_id)\n</code></pre>"},{"location":"guides/integrations/#3-the-tool-agnostic-brain","title":"3. The \"Tool-Agnostic\" Brain","text":"<p>The core reasoning engine (<code>CommitVigilBrain</code>) never interacts with Slack or Git directly. It processes semantic commitments and returns behavioral decisions. This means you can swap the entire communication layer without touching the AI logic.</p>"},{"location":"guides/integrations/#supported-data-formats","title":"Supported Data Formats:","text":"<ul> <li>JSON API: For direct application integration.</li> <li>Markdown: For documentation and PR reviews.</li> <li>HTML: For executive reporting.</li> </ul>"},{"location":"guides/integrations/#future-golden-paths","title":"\ud83d\ude80 Future Golden Paths","text":"<ul> <li>Jira Adapter: Automatically close Jira tickets when the \"Fulfillment Analysis\" confirms the task is done in Git.</li> <li>Email Gateway: Send \"Professional Nudges\" via SendGrid for high-context executive summaries.</li> </ul>"},{"location":"guides/managers/","title":"The Accountability Handbook: A Guide for Managers \ud83d\udc54","text":"<p>CommitVigil is a tool of empowerment, not surveillance. For a Human-in-the-Loop (HITL) system to work, managers must know how to translate AI flags into professional leadership.</p>"},{"location":"guides/managers/#1-interpreting-the-flags","title":"1. Interpreting the Flags","text":"<p>When CommitVigil flags an \"Ambiguity\" or a \"Truth Gap,\" it is a prompt for a conversation, not a citation for failure.</p> <ul> <li> <p>Flag: \"Ambiguous Commitment\"</p> <ul> <li>AI Logic: The user's words were too vague to extract a deadline.</li> <li>Manager Action: Don't scold. Instead, reply: \"Hey [Name], I saw your update. To help me clear any blockers, could you give me a rough target for when you'll have this in review?\"</li> <li>Goal: Precision, not pressure.</li> </ul> </li> <li> <p>Flag: \"Truth Gap Detected\"</p> <ul> <li>AI Logic: Verbal claims don't match Git evidence.</li> <li>Manager Action: Assume there is a technical blocker. Ask: \"I noticed the repo hasn't updated since our chat. Are there any local environment issues or merge conflicts I should jump in on?\"</li> <li>Goal: Removing blockers, not investigating honesty.</li> </ul> </li> </ul>"},{"location":"guides/managers/#2-managing-the-human-in-the-loop-hitl","title":"2. Managing the \"Human-in-the-Loop\" (HITL)","text":"<p>High-stakes interventions should never be 100% autonomous.</p> <ol> <li>Review the Confidence Score: If the AI has a <code>confidence_score</code> of 0.8 but flags a high risk, verify if the user's recent Slack messages were sarcastic or high-context.</li> <li>Calibrate for Morale: If the team has just finished a \"Death March\" (long sprint), manually increase the Supportive Threshold to allow for natural recovery.</li> <li>Verify New Contexts: If the system flags a \"New Industry/Department\", review the generated safety rules. Once confirmed, Lock the Context to prevent future drift.</li> <li>Cross-Cultural Norms: Ensure your specific team's \"Directness Level\" is reflected in the agent's tone settings.</li> </ol>"},{"location":"guides/managers/#3-best-practices-for-professionalism","title":"3. Best Practices for Professionalism","text":"<ul> <li>Public vs. Private: CommitVigil monitors public channels, but follow-up interventions for high-risk signals should often be moved to a 1-on-1 private DM thread once the manager is alerted.</li> <li>Celebrate the Reliability: When someone consistently hits 100% on their Reliability Score, use the report as a basis for formal recognition. Accountability is as much about Praise as it is about Progress.</li> </ul>"},{"location":"guides/managers/#4-configuring-your-teams-voice","title":"4. Configuring Your Team's Voice \ud83c\udf9a\ufe0f","text":"<p>Managers can adjust the system's \"psychological pressure\" via environment variables:</p> <ul> <li><code>CULTURAL_DIRECTNESS_LEVEL</code>: Set to <code>low</code> for high-context or sensitive teams. This forces the LLM to use more indirect, softer language even when flagging risks.</li> <li><code>COOLING_OFF_PERIOD_HOURS</code>: Adjust the duration of the \"Tone Damping\" state (Default: 48 hours).</li> </ul>"},{"location":"guides/managers/#5-the-performance-integrity-audit","title":"5. The Performance Integrity Audit \ud83d\udcca","text":"<p>Managers can now generate high-value, professional audit reports for their team members. This is the primary tool for quarterly reviews or high-stakes interventions.</p>"},{"location":"guides/managers/#how-to-generate-a-sellable-pdf","title":"How to Generate a Sellable PDF:","text":"<ol> <li>Request the Audit: Call the API with <code>report_format=html</code>.</li> <li>Save as PDF: Open the HTML file in your browser and use Print to PDF.</li> <li>Deliver: The report features a \"Truth Gap\" analysis and a \"burnout risk\" scorecard designed for professional executive presentation.</li> </ol> <p>[!TIP] Use the Markdown format for embedding audit summaries directly into GitHub Pull Request comments for collective accountability.</p>"},{"location":"guides/managers/#6-sales-enablement-roi","title":"6. Sales Enablement &amp; ROI \ud83d\udcb0","text":"<p>For leaders justifying the budget for CommitVigil, use the ROI Calculator:</p> <ul> <li>Projected Savings: Calculates recovered developer hours based on a 40% reduction in \"Engagement Slippage\".</li> <li>Executive Briefs: Generate a one-page HTML summary for your CFO using the <code>/sales/executive-brief</code> endpoint.</li> </ul>"},{"location":"guides/production/","title":"Production &amp; Enterprise Deployment Guide \ud83d\ude80","text":"<p>Scaling CommitVigil to 1000+ users requires moving from a local monolithic setup to a distributed, high-availability architecture.</p>"},{"location":"guides/production/#enterprise-architecture","title":"\ud83c\udfd7\ufe0f Enterprise Architecture","text":"<p>For large-scale teams, we separate the Ingestion Layer (API) from the Processing Layer (Workers).</p> <ol> <li>API Layer: Stateless FastAPI pods behind a Load Balancer (AWS ALB / Nginx).</li> <li>Processing Layer: Distributed <code>arq</code> workers scaling horizontally based on queue depth.</li> <li>State Layer: Managed Redis (AWS ElastiCache) and PostgreSQL (AWS RDS).</li> </ol>"},{"location":"guides/production/#kubernetes-orchestration","title":"\u2638\ufe0f Kubernetes Orchestration","text":"<p>We provide production-ready K8s manifests in <code>infra/k8s/</code>.</p>"},{"location":"guides/production/#key-scaling-features","title":"Key Scaling Features:","text":"<ul> <li>Replica Sets: Run multiple API instances to handle high traffic.</li> <li>Auto-Scaling (HPA): Workers automatically scale from 2 to 20+ pods based on CPU usage or queue backlog.</li> <li>Resource Constraints: Strict CPU/Memory limits to prevent noisy-neighbor issues on shared clusters.</li> </ul>"},{"location":"guides/production/#deployment-command","title":"Deployment Command:","text":"<pre><code>kubectl apply -f infra/k8s/\n</code></pre>"},{"location":"guides/production/#automated-org-wide-ingestion","title":"\ud83d\udd04 Automated Org-Wide Ingestion","text":"<p>Managers don't need to manually ingest commits. Use GitHub Webhooks at the Organization level:</p> <ol> <li>Go to GitHub Organization Settings -&gt; Webhooks.</li> <li>Add a new webhook:<ul> <li>Payload URL: <code>https://api.commitvigil.yourcloud.com/api/v1/ingest/git</code></li> <li>Content Type: <code>application/json</code></li> <li>Secret: Your fixed <code>API_KEY_SECRET</code></li> <li>Events: Select <code>Pushes</code>.</li> </ul> </li> </ol> <p>Result: Every commit from every repo in your organization is automatically processed for accountability.</p>"},{"location":"guides/production/#bulk-identity-sync-sso","title":"\ud83c\udd94 Bulk Identity Sync (SSO)","text":"<p>Mapping 1000+ users via <code>curl</code> is inefficient. Implement a Mapping Sync Service:</p> <ul> <li>Active Directory / Google Workspace: Write a small cronjob that polls your employee list and calls:</li> <li><code>POST /api/v1/users/config/slack</code> (Email -&gt; Slack ID)</li> <li><code>POST /api/v1/users/config/git</code> (Email -&gt; Git Email)</li> <li>Automatic Discovery: CommitVigil can be configured to use the Slack <code>users.lookupByEmail</code> API to auto-map users on their first commitment.</li> </ul>"},{"location":"guides/production/#monitoring-observability","title":"\ud83d\udcca Monitoring &amp; Observability","text":"<p>Enterprise deployment includes Prometheus + Grafana integration:</p> <ul> <li>SLIs (Service Level Indicators):</li> <li><code>background_jobs_pending</code>: How many commitments are waiting for AI processing?</li> <li><code>ai_token_usage_total</code>: Cost tracking per team/department.</li> <li><code>intervention_acceptance_rate</code>: How often are managers acting on AI pings?</li> </ul>"},{"location":"guides/production/#finops-optimizing-llm-costs","title":"\ud83d\udcb0 FinOps: Optimizing LLM Costs","text":"<p>At 1000+ users, token costs can add up. CommitVigil helps you optimize:</p> <ol> <li>Provider Switching: Use Groq (Llama 3.3 70b) for high-speed, low-cost extraction, and OpenAI (GPT-4o) only for complex tone adaptation.</li> <li>Mock Mode for Non-Critical Repos: Use <code>LLM_PROVIDER=\"mock\"</code> for internal experimental repositories to save budget.</li> <li>Caching: CommitVigil can be extended with a vector cache (like RedisVL) to reuse extracted tasks from similar commit messages.</li> </ol> <p>[!IMPORTANT] Always deploy in a Zero-Trust environment using encrypted secrets and private network VPCs for the Database and Redis.</p>"},{"location":"guides/quickstart/","title":"Quick Start Guide \u26a1","text":"<p>Get CommitVigil running in under 5 minutes.</p>"},{"location":"guides/quickstart/#running-with-docker-recommended","title":"\ud83d\udc33 Running with Docker (Recommended)","text":"<p>The fastest way to spin up the full stack (API + Worker + Redis + Postgres):</p> <pre><code>docker compose up --build\n</code></pre>"},{"location":"guides/quickstart/#local-setup","title":"\ud83c\udfd7\ufe0f Local Setup","text":"<ol> <li>Install dependencies:     <pre><code># Recommendation: Use uv for high-performance dependency resolution\nuv sync\n# OR standard poetry\npoetry install\n</code></pre></li> <li>Configure Environment:     Create a <code>.env</code> file based on <code>.env.example</code>.      &gt; Important: Set <code>API_KEY_SECRET</code> to a secure value for production. Set <code>AUTH_ENABLED=False</code> for local testing without auth.</li> <li>Run the API:     <pre><code>poetry run uvicorn src.main:app --reload\n</code></pre></li> <li>Run the Worker:     <pre><code>poetry run arq src.worker.WorkerSettings\n</code></pre></li> </ol>"},{"location":"guides/quickstart/#interactive-demos","title":"\ud83c\udfae Interactive Demos","text":"<p>See the system in action with these pre-configured scenarios:</p>"},{"location":"guides/quickstart/#1-high-stakes-accountability","title":"1. High-Stakes Accountability","text":"<p>Simulates a manager-developer interaction with tone adaptation and safety checks. <pre><code>./scripts/demo.sh\n</code></pre></p>"},{"location":"guides/quickstart/#2-sales-intelligence-roi","title":"2. Sales Intelligence &amp; ROI","text":"<p>Simulates a prospecting flow with automated scenario generation and multi-currency ROI. <pre><code>./scripts/demo_sales.sh\n</code></pre></p>"},{"location":"guides/quickstart/#quality-and-stability","title":"\ud83e\uddea Quality and Stability","text":"<p>CommitVigil enforces military-grade engineering standards: - Mock Mode: Set <code>LLM_PROVIDER=\"mock\"</code> in <code>.env</code> to run the entire system with zero token cost. - Strict Typing: The system is fully compliant with <code>mypy</code> strict type checking. Run <code>poetry run mypy src/</code> to verify correctness. - Coverage: All critical agents maintain a high test coverage threshold.</p> <pre><code># Run tests with clean output\nuv run pytest\n</code></pre>"},{"location":"guides/sales/","title":"Sales Enablement Guide \ud83d\ude80","text":"<p>CommitVigil isn't just a tool; it's a platform with built-in sales intelligence to help you close enterprise deals.</p>"},{"location":"guides/sales/#1-the-drift-scenario-generator","title":"1. The \"Drift Scenario\" Generator","text":"<p>Prospects often don't realize how much \"Engagement Slippage\" costs them. Use the Prospecting Agent to generate industry-specific examples of failed commitments.</p>"},{"location":"guides/sales/#usage","title":"Usage","text":"<pre><code>curl -X POST \"$API_URL/sales/prospect?company_name=AcmeCorp&amp;industry=healthcare\"\n</code></pre>"},{"location":"guides/sales/#output-value","title":"Output Value","text":"<ul> <li>Realistic Scenarios: The AI will generate examples like \"Lead Researcher promised safety data by Friday but no commit was found.\"</li> <li>Targeted Role: It automatically targets the persona (e.g., CTO, VP Eng) relevant to that industry.</li> </ul>"},{"location":"guides/sales/#2-multi-currency-roi-calculator","title":"2. Multi-Currency ROI Calculator","text":"<p>Close deals faster by showing the math. The calculator supports <code>USD</code>, <code>EUR</code>, and <code>GBP</code>.</p>"},{"location":"guides/sales/#usage_1","title":"Usage","text":"<pre><code>curl -X GET \"$API_URL/sales/roi-calculator?team_size=50&amp;avg_salary=120000&amp;currency=EUR\"\n</code></pre>"},{"location":"guides/sales/#key-metrics","title":"Key Metrics","text":"<ul> <li>Annual Savings: The raw cash value of recovered time.</li> <li>Payback Period: Usually &lt; 1 month for teams &gt; 10.</li> <li>Efficiency Gain: The % improvement in delivery velocity.</li> </ul>"},{"location":"guides/sales/#3-the-executive-brief-the-closer","title":"3. The Executive Brief (The \"Closer\")","text":"<p>Generate a premium, glassmorphic HTML one-pager to send as a follow-up after your demo.</p>"},{"location":"guides/sales/#steps","title":"Steps","text":"<ol> <li>Run the generation command:     <pre><code>curl -X POST \"$API_URL/sales/executive-brief?company_name=BigBank...\" &gt; brief.html\n</code></pre></li> <li>Print to PDF.</li> <li>Email to the Champion/Decision Maker.</li> </ol>"},{"location":"guides/sales/#internal-use-only","title":"\ud83d\udd12 Internal Use Only","text":"<ul> <li>Demo Mode: Ensure <code>DEMO_MODE=false</code> in production to use real reasoning.</li> <li>Rate Limits: The sales endpoints are rate-limited to 10 requests/minute.</li> </ul>"},{"location":"guides/slack/","title":"Slack Integration Guide \ud83d\udcac","text":"<p>Transform the agent into a visible collaborator by bridging it to your Slack workspace.</p>"},{"location":"guides/slack/#1-webhook-setup-step-by-step","title":"1. Webhook Setup (Step-by-Step)","text":""},{"location":"guides/slack/#step-1-access-slack-api","title":"Step 1: Access Slack API","text":"<ol> <li>Open your browser and navigate to api.slack.com/apps</li> <li>Sign in with your Slack workspace credentials if prompted</li> </ol>"},{"location":"guides/slack/#step-2-create-a-new-app","title":"Step 2: Create a New App","text":"<ol> <li>Click the green \"Create New App\" button</li> <li>Select \"From scratch\" (not from a manifest)</li> <li>Fill in the form:</li> <li>App Name: <code>CommitVigil</code> (or any name you prefer)</li> <li>Pick a workspace: Select your Slack workspace from the dropdown</li> <li>Click \"Create App\"</li> </ol>"},{"location":"guides/slack/#step-3-enable-incoming-webhooks","title":"Step 3: Enable Incoming Webhooks","text":"<ol> <li>After creating the app, you'll land on the Basic Information page</li> <li>In the left sidebar under \"Features\", click \"Incoming Webhooks\"</li> <li>Toggle the switch ON at the top of the page</li> <li>You'll see a confirmation: \"Incoming Webhooks are On\"</li> </ol>"},{"location":"guides/slack/#step-4-add-webhook-to-channel","title":"Step 4: Add Webhook to Channel","text":"<ol> <li>Scroll down to \"Webhook URLs for Your Workspace\"</li> <li>Click \"Add New Webhook to Workspace\"</li> <li>A popup will ask: \"Where should CommitVigil post?\"</li> <li>Select your target channel (e.g., <code>#engineering</code>, <code>#accountability</code>)</li> <li>Click \"Allow\"</li> <li>Copy the generated webhook URL:    <pre><code>https://hooks.slack.com/services/YOUR_WORKSPACE_ID/YOUR_APP_ID/YOUR_WEBHOOK_TOKEN\n</code></pre></li> </ol>"},{"location":"guides/slack/#2-configuration","title":"2. Configuration","text":"<p>Add the webhook URL to your <code>.env</code> file: <pre><code>SLACK_WEBHOOK_URL=\"https://hooks.slack.com/services/WORKSPACE_ID/APP_ID/TOKEN\"\n</code></pre></p> <p>Restart the service to apply changes: <pre><code>docker compose down &amp;&amp; docker compose up --build\n</code></pre></p>"},{"location":"guides/slack/#3-test-the-webhook","title":"3. Test the Webhook","text":"<p>Verify connectivity with a simple curl command: <pre><code>curl -X POST \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"text\": \"\ud83d\udee1\ufe0f CommitVigil is connected!\"}' \\\n  'YOUR_WEBHOOK_URL'\n</code></pre></p> <p>You should see <code>ok</code> in the terminal and the message in your Slack channel.</p>"},{"location":"guides/slack/#4-user-mentions-identity-mapping","title":"4. User @Mentions (Identity Mapping)","text":"<p>CommitVigil can ping users directly using their Slack Member ID.</p>"},{"location":"guides/slack/#how-to-find-a-slack-member-id","title":"How to Find a Slack Member ID","text":"<ol> <li>Open Slack and go to the user's profile</li> <li>Click \"More\" (three dots)</li> <li>Select \"Copy Member ID\"</li> </ol>"},{"location":"guides/slack/#how-to-map-a-user","title":"How to Map a User","text":"<p>Call the configuration endpoint: <pre><code>curl -X POST \\\n  -H 'X-API-Key: YOUR_API_KEY' \\\n  'http://localhost:8000/api/v1/users/config/slack?user_id=john_dev&amp;slack_id=U12345678'\n</code></pre></p>"},{"location":"guides/slack/#the-result","title":"The Result","text":"<p>When an alert is triggered, Slack turns the ID into a real mention:</p> <p>\ud83d\udd14 CommitVigil Alert for @John: Checking in on commitment: fix the CSS bugs</p> <p>[!TIP] You can create multiple webhooks for different channels (e.g., <code>#urgent-alerts</code> for critical issues, <code>#commitment-log</code> for routine tracking).</p>"},{"location":"operations/RUNBOOK-001-Redis-Failure/","title":"RUNBOOK-001: Handling Redis Connection Failures","text":""},{"location":"operations/RUNBOOK-001-Redis-Failure/#overview","title":"Overview","text":"<p>Redis is used for Rate Limiting (<code>fastapi-limiter</code>) and Background Job Queueing (<code>arq</code>). A Redis failure degrades system performance but should not cause a total API blackout.</p>"},{"location":"operations/RUNBOOK-001-Redis-Failure/#symptoms","title":"Symptoms","text":"<ul> <li>Logs: <code>redis_connection_failed</code> warnings.</li> <li>API: Returns <code>503 Service Unavailable</code> on <code>/evaluate</code> endpoints.</li> <li>Prometheus: <code>background_jobs_pending</code> metrics stop updating.</li> </ul>"},{"location":"operations/RUNBOOK-001-Redis-Failure/#emergency-mitigation","title":"Emergency Mitigation","text":""},{"location":"operations/RUNBOOK-001-Redis-Failure/#1-identify-the-scope","title":"1. Identify the Scope","text":"<ul> <li>If API is up but Worker is down: Commitments will accumulate in Redis. Scale up the <code>worker</code> deployment.</li> <li>If Redis is down: The API will fail to enqueue jobs.</li> </ul>"},{"location":"operations/RUNBOOK-001-Redis-Failure/#2-manual-recovery-docker","title":"2. Manual Recovery (Docker)","text":"<pre><code>docker compose restart redis\ndocker compose logs -f redis\n</code></pre>"},{"location":"operations/RUNBOOK-001-Redis-Failure/#3-kubernetes-recovery","title":"3. Kubernetes Recovery","text":"<pre><code>kubectl rollout restart deployment commitvigil-redis\n</code></pre>"},{"location":"operations/RUNBOOK-001-Redis-Failure/#4-verification-check","title":"4. Verification Check","text":"<p>Call the health endpoint: <pre><code>curl http://localhost:8000/health\n</code></pre> Verify <code>\"redis\": \"healthy\"</code> inside the <code>dependencies</code> block of the JSON response.</p>"},{"location":"operations/RUNBOOK-001-Redis-Failure/#post-failure-analysis","title":"Post-Failure Analysis","text":"<p>Check Token Usage logs to ensure no duplicate withdrawals occurred during the reconnection window.</p>"},{"location":"overviews/agents/","title":"Agentic Reasoning Logic \ud83e\udde0","text":"<p>CommitVigil uses three distinct layers of reasoning to decide how to intervene.</p>"},{"location":"overviews/agents/#1-excuse-analysis-excusedetector","title":"1. Excuse Analysis (<code>ExcuseDetector</code>)","text":"<p>The agent categorizes the check-in sentiment: - Legitimate: Family emergencies, personal health. - Deflection: \"Too busy,\" \"I forgot,\" \"I'll do it later.\" - Burnout Signal: Linguistic markers of deep fatigue or loss of interest.</p>"},{"location":"overviews/agents/#2-predictive-risk-scoring-riskscorer","title":"2. Predictive Risk Scoring (<code>RiskScorer</code>)","text":"<p>The agent generates a score (0.0 - 1.0) based on: - The Confidence of the current check-in. - The Historical Reliability of the user (stored in PostgreSQL). - The Category of the excuse.</p>"},{"location":"overviews/agents/#3-tone-adaptation-toneadapter","title":"3. Tone Adaptation (<code>ToneAdapter</code>)","text":"<p>The final decision is a personalized intervention: - Tone: Supportive - If risk is high but burnout is detected. - Tone: Firm - If risk is high and the user has a history of deflection. - Tone: Neutral - For standard updates. - Tone: Confrontational - For repeat deflection.</p>"},{"location":"overviews/agents/#4-safety-audit-safetysupervisor","title":"4. Safety Audit (<code>SafetySupervisor</code>)","text":"<p>The \"Overwatch\" layer acts as a final sanity check before any intervention is sent. It enforces the Industry-Specific Semantic Firewall: - Departmental Granularity: Applies rules specific to <code>Finance:Trading</code> or <code>Tech:R&amp;D</code> before falling back to industry-wide policies. - Autonomous Onboarding: If a new organizational context is detected, the agent generates preliminary safety rules and flags them for human review. - Healthcare (HIPAA): Hard-blocks unauthorized PII or clinical mandates. - Finance (SEC): Prevents market manipulation or non-compliant financial advice.</p>"},{"location":"overviews/agents/#5-context-sensing-contextscout","title":"5. Context Sensing (<code>ContextScout</code>)","text":"<p>A specialized agent that continuously analyzes communication patterns to detect the operational environment: - Industry &amp; Department: Automatically identifies if a user is in \"Legal\", \"Engineering\", or \"Sales\". - Confidence Scoring: Assigns a 0-100% confidence to every detection. - Stabilization: If confidence is low or the context is new, it triggers a Human-in-the-Loop verification request.</p>"},{"location":"overviews/agents/#5-cultural-persona-architecture","title":"5. Cultural Persona Architecture","text":"<p>CommitVigil adapts the ToneAdapter to the cultural context of the user: - Japanese (<code>ja</code>): High-context, polite, and face-saving interventions. - German (<code>de</code>): Direct, technical, and objective accountability. - African Ubuntu (<code>en-AF</code>): Communal, relationship-centric, and narrative-driven check-ins. - British (<code>en-UK</code>): Nuanced, polite persistence.</p>"},{"location":"overviews/agents/#example-decision","title":"Example Decision","text":"<p>Input: \"I'm really tired, the bugs are harder than I thought, might miss it.\"</p> <p>Agent Decision: - Category: Burnout Signal - Risk: High (0.85) - Tone: Supportive - Action: \"Hey @User, I'm detecting some burnout signs. Let's look at the scope together before the deadline.\"</p>"},{"location":"overviews/agents/#6-sales-intelligence-prospectingscout","title":"6. Sales Intelligence (<code>ProspectingScout</code>)","text":"<p>A specialized agent designed to generate high-fidelity \"Drift Scenarios\" for sales demos. It: - Synthesizes fictional but realistic commitment failures based on the prospect's industry (e.g., \"Missed FDA Compliance Check\" for Biotech). - Calculates ROI based on team size, average salary, and slippage recovery rates. - Generates Executive Briefs for C-Level presentations.</p>"},{"location":"overviews/customization/","title":"Customization &amp; \"Open Intel\" Policy \ud83d\udee0\ufe0f","text":"<p>CommitVigil is designed for flexibility. We believe that teams should have total control over the \"sensitivity\" and \"personality\" of their accountability agents.</p>"},{"location":"overviews/customization/#1-tuning-sensitivity-thresholds","title":"1. Tuning Sensitivity Thresholds","text":"<p>You can customize the system's \"Strictness\" and \"Caution\" via environment variables in your <code>.env</code> file:</p> <ul> <li><code>MIN_AI_CONFIDENCE_THRESHOLD</code>: (Default: <code>0.75</code>) <ul> <li>Any extraction or sentiment analysis with a confidence score below this value will be flagged for Human-in-the-Loop review. </li> <li>Increase this to <code>0.90</code> for highly conservative teams.</li> </ul> </li> <li><code>COOLING_OFF_PERIOD_HOURS</code>: (Default: <code>48</code>) <ul> <li>Controls how long the system dampens pressure after a period of high-stakes interventions.</li> </ul> </li> </ul>"},{"location":"overviews/customization/#example-tuning-for-cultural-context","title":"Example: Tuning for Cultural Context","text":"Setting Agent Output (Reliability 40%) Cultural Vibe High \"Refactor is overdue. Confirm delivery by 5 PM.\" Direct, task-oriented. Medium \"The refactor is lagging. Can we prioritize this?\" Professional, collaborative. Low \"I noticed the refactor\u2014is there any way I can help?\" Indirect, supportive."},{"location":"overviews/customization/#2-model-configs-context-injection","title":"2. Model Configs &amp; Context Injection","text":"<p>The \"Secret Sauce\" of CommitVigil is in the System Prompts. You can find and modify the decision-making logic in the following locations:</p> <ul> <li>Behavioral Reasoning: Located in src/agents/brain.py.</li> <li>Safety Supervision: Located in src/agents/safety.py.</li> </ul>"},{"location":"overviews/customization/#3-message-lifecycle-safety-overwatch","title":"3. Message Lifecycle &amp; \"Safety Overwatch\" \ud83d\udef0\ufe0f","text":"<p>The Safety Supervisor follows a Post-Generation Overwatch pattern. This ensures that the system is self-healing without entering infinite regeneration loops.</p> <pre><code>graph TD\n    A[User Action/Commitment] --&gt; B[Behavioral Brain]\n    B --&gt; C{Verified Context?}\n    C --&gt;|Yes| D[Lock Context &amp; Skip Sensing]\n    C --&gt;|No| E[Autonomous Sensing (ContextScout)]\n    E --&gt; F{Safety Supervisor Audit}\n    F --&gt;|Pass| G[Send Message]\n    F --&gt;|Unverified| H[Flag for Human Review]\n    F --&gt;|Soft Correction| I[Inject Rewrite]\n    I --&gt; G\n\n    style H fill:#ff6b6b\n    style G fill:#51cf66\n    style D fill:#ffd43b</code></pre>"},{"location":"overviews/customization/#the-injection-mechanism-hybrid-corrections","title":"The Injection Mechanism (Hybrid Corrections)","text":"<p>The Supervisor now employs a Cost-Optimized Hybrid Strategy: - Surgical Replace: For minor tone issues, it swaps specific phrases (e.g., \"Fix this now\" -&gt; \"Can we address this?\"), saving token costs. - Full Rewrite: For major toxicity or clarity issues, it regenerates the entire message to ensure semantic coherence.</p>"},{"location":"overviews/customization/#supervisor-aware-confidence","title":"Supervisor-Aware Confidence","text":"<p>To prevent \"hallucinated safety,\" the Supervisor has its own self-doubt mechanic. If its internal confidence score drops below 0.8 (e.g., confusing idioms or ambiguous sarcasm), it will refuse to correct the message and instead flag it for <code>requires_human_review</code>.</p>"},{"location":"overviews/customization/#audit-trail-governance","title":"Audit Trail &amp; Governance","text":"<p>Every intervention is logged with the following metadata for team-level analytics: *   Correction Rate: % of messages modified by the Supervisor. *   Hard-Block Trigger: Messages touching HR/Legal boundaries (salary, performance reviews) are blocked and logged. *   Reasoning Map: The specific \"Morale Risk\" analysis that triggered the correction.</p>"},{"location":"overviews/customization/#4-training-data-fine-tuning","title":"4. Training Data &amp; Fine-Tuning","text":"<p>While the core logic uses Zero-Shot and Few-Shot reasoning via Pydantic/Instructor:</p> <ul> <li>Custom Schemas: You can modify <code>src/schemas/agents.py</code> to add new fields (e.g., tracking specific project jargon or regional communication styles).</li> <li>Scenario Libraries: We recommend teams build a library of \"Ambiguous Slack Messages\" relevant to their industry.</li> </ul>"},{"location":"overviews/customization/#5-prompt-templates-for-forking","title":"5. Prompt Templates for Forking \ud83d\udd31","text":"<p>To help teams customize the \"Agentic Personality,\" here are the core system prompts used in CommitVigil. You can \"fork\" these by modifying the code in the respective files.</p>"},{"location":"overviews/customization/#a-the-behavioral-brain-srcagentsbrainpy","title":"A. The Behavioral Brain (<code>src/agents/brain.py</code>)","text":"<p>This prompt handles the core accountability decision logic. <pre><code>Determine action and tone. \nUser Reliability: {reliability_score}%\nConsecutive Strict Interventions: {consecutive_firm_calls}\nManager's Cultural Directness Setting: {settings.CULTURAL_DIRECTNESS_LEVEL}\n\nRULES:\n- If Consecutive Strict &gt;= 3, you MUST use SUPPORTIVE/NEUTRAL tone to avoid morale burnout.\n- Respect the Cultural Directness: if 'low', soften all firm feedback.\n</code></pre></p>"},{"location":"overviews/customization/#b-the-safety-supervisor-srcagentssafetypy","title":"B. The Safety Supervisor (<code>src/agents/safety.py</code>)","text":"<p>This prompt acts as the ethical auditor. <pre><code>AUDIT REQUEST:\nProposed Message: \"{message}\"\nIntended Tone: {tone}\nUser Context (Reliability/History): {user_context}\n\nCRITICAL TASK:\nAnalyze if this message is likely to cause long-term resentment or morale damage.\nSystem Target Confidence: {settings.MIN_AI_CONFIDENCE_THRESHOLD}\n\nIf the message is too harsh (Tone Drift) or culturally insensitive, flag it as unsafe.\nIf the internal confidence in the current analysis is likely below the threshold, flag 'requires_human_review'.\n</code></pre></p>"},{"location":"overviews/customization/#safety-supervisor-decision-tree","title":"Safety Supervisor Decision Tree","text":"Input Tone Message Analysis Decision Action FIRM \"Delivery is missed. Fix now.\" Unsafe Rewrite to: \"We missed the delivery. Can you update the team on the blockers?\" BURN \"You look busy, take a day off.\" Safe Proceed. N/A Confidence in extraction is &lt;75%. HITL Flag for <code>requires_human_review</code>."},{"location":"overviews/customization/#6-validation-guide-testing-your-tuning","title":"6. Validation Guide: Testing Your Tuning \ud83e\uddea","text":"<p>When you modify prompts, use the following manual verification flow:</p> <ol> <li>Unit Tests: Run <code>pytest tests/test_brain.py</code> to ensure core logic isn't broken.</li> <li>Scenario Probing: Use the <code>/evaluate</code> endpoint with a known \"Ambiguous\" message (e.g., \"Maybe I'll finish if I feel better\").</li> <li>Audit Check: Verify the <code>Safety Supervisor</code> flags the output correctly for your new settings.</li> <li>Morale Metric: After 1 week of deployment, check the <code>consecutive_firm_interventions</code> count in your database to ensure the \"Cooling-off\" logic is triggering.</li> </ol>"},{"location":"overviews/customization/#7-open-source-strategy","title":"7. Open Source Strategy","text":"<p>We plan to release Anonymized Scenario Sets\u2014a dataset of human-labeled engineering commitments\u2014to help the community build more empathetic and accurate accountability agents.</p>"},{"location":"overviews/ethics/","title":"Ethics, Privacy &amp; Professionalism \ud83d\udee1\ufe0f","text":"<p>CommitVigil is a high-pressure accountability tool, but it is built with the \"Supportive First\" philosophy. Addressing feedback on the human implications of AI-driven enforcement is critical for enterprise adoption.</p>"},{"location":"overviews/ethics/#1-ethical-tone-escalation","title":"1. Ethical Tone Escalation","text":"<p>One of our most discussed features is the \"Confrontational\" tone. Here is how we handle it ethically:</p> <ul> <li>The Empathy Buffer: The system is hardcoded to prioritize <code>SUPPORTIVE</code> tones if anything resembling burnout or personal distress is detected.</li> <li>The Burnout Safety Valve: If the <code>ExcuseDetector</code> identifies signs of fatigue, the system blocks confrontational escalation and triggers a \"Burnout Alert\" for the manager instead. </li> <li>Tone Drift &amp; Cooling-off: To prevent morale fatigue, the system implements mathematical tone-damping. If a user receives 3 consecutive \"Firm\" or \"Confrontational\" follow-ups, the logic automatically locks the agent into a <code>NEUTRAL</code> or <code>SUPPORTIVE</code> state for 48 hours (configurable via <code>COOLING_OFF_PERIOD_HOURS</code>).</li> </ul>"},{"location":"overviews/ethics/#2-industry-specific-semantic-firewall","title":"2. Industry-Specific Semantic Firewall \ud83e\uddf1","text":"<p>CommitVigil provides hard-coded safety guarantees for regulated industries: *   Healthcare (HIPAA): The system hard-blocks unauthorized medical mandates or PII disclosure.  *   Finance (SEC): Prevents the agent from accidentally facilitating market manipulation or providing unregulated financial advice. *   HR Territory: Discussions involving <code>Salary</code>, <code>PIP</code> (Performance Improvement Plans), or <code>Firing</code> are immediately escalated to human review.</p>"},{"location":"overviews/ethics/#3-continuous-learning-roi-metrics","title":"3. Continuous Learning &amp; ROI Metrics \ud83d\udcc8","text":"<p>CommitVigil doesn't just act; it learns: *   Manager Feedback Loop: Every intervention can be reviewed by a supervisor. Their \"Accept/Modify/Reject\" decisions are persisted. *   ROI Dashboard: The system calculates the Intervention Acceptance Rate to quantify the AI's alignment with management intent.</p> <ul> <li>Sensitivity Calibration: CommitVigil supports Cultural Tone Profiles. Managers can calibrate the \"Pressure Sensitivity\" of the agents to match their specific team norms (e.g., High-Directness vs. High-Context locales).</li> <li>Domain-Specific Jargon: The NLP models are refined to recognize that certain industry vernacular (e.g., \"I'm swamped\") may be a routine status update rather than an excuse in specific high-velocity teams.</li> </ul>"},{"location":"overviews/ethics/#4-privacy-data-integrity","title":"4. Privacy &amp; Data Integrity","text":"<p>Monitoring at the granularity of Slack threads and Git commits requires a strict privacy stance:</p> <ul> <li>Scoped Monitoring: CommitVigil is designed to monitor designated <code>#project</code> channels, not private DMs or unrelated chatter.</li> <li>Source-Level Only: Commit monitoring is restricted to commit messages and PR metadata\u2014not the proprietary logic within the source code files themselves.</li> <li>Identity Anonymization: Internal IDs are used for analysis; real names can be masked in the database if necessary.</li> </ul>"},{"location":"overviews/ethics/#5-handling-ambiguity-the-100-visibility-claim","title":"5. Handling Ambiguity (The \"100% Visibility\" Claim) \ud83e\udde0","text":"<p>Ambiguity is the greatest challenge in Engineering NLP. Here is how we move toward high accuracy:</p> <ul> <li>Confidence Scores: Every extraction (Commitment, Risk, Excuse) is accompanied by a <code>confidence_score</code>.</li> <li>Human-in-the-Loop (HITL): If a score falls below 0.75, the system flags the extraction as \"Ambiguous\" and asks the manager for manual validation instead of taking autonomous action.</li> <li>Semantic Context: By correlating Git activity with Slack messages, we resolve ambiguity. If a dev says \"I'll handle it,\" but we see a corresponding Git branch with the task name, the \"soft commitment\" is confirmed.</li> </ul>"},{"location":"overviews/ethics/#deployment-the-future","title":"\ud83d\ude80 Deployment &amp; The Future","text":"<p>Why build this? CommitVigil was inspired by the \"Slack Stall\"\u2014the invisible friction where professional promises disappear into the scroll history of remote teams. It turns \"I'll get to it\" into a technical obligation.</p> <p>Real-World Testing: The next phase of the project involves a Private Beta where the <code>TruthGapDetector</code> will be tested against real-world ambiguous data to refine its \"Precision Accountability\" engine.</p>"},{"location":"reference/api/","title":"API Reference \ud83d\udcd6","text":"<p>CommitVigil provides a clean RESTful interface for all operations.</p>"},{"location":"reference/api/#commitment-ingestion","title":"\ud83d\udce5 Commitment Ingestion","text":""},{"location":"reference/api/#src.api.v1.ingestion.ingest_raw_commitment","title":"<code>src.api.v1.ingestion.ingest_raw_commitment(user_id, raw_text)</code>  <code>async</code>","text":"<p>Elite Feature: Extract structured commitment record from raw Slack/Discord text.</p>"},{"location":"reference/api/#src.api.v1.ingestion.ingest_git_commitment","title":"<code>src.api.v1.ingestion.ingest_git_commitment(commit_data)</code>  <code>async</code>","text":"<p>Advanced GitOps Feature: Extract commitments directly from Git Commit Messages.</p>"},{"location":"reference/api/#accountability-evaluation","title":"\ud83d\udea6 Accountability Evaluation","text":""},{"location":"reference/api/#src.api.v1.evaluation.evaluate_commitment","title":"<code>src.api.v1.evaluation.evaluate_commitment(update, sync=False, redis=Depends(get_redis))</code>  <code>async</code>","text":"<p>Main ingestion gateway for commitment evaluations. - Production (Default): Enqueues job in Redis for background processing. - Sync Mode (sync=true): Executes pipeline immediately (useful for demos and low-latency chatbots).</p>"},{"location":"reference/api/#user-configuration","title":"\u2699\ufe0f User Configuration","text":""},{"location":"reference/api/#src.api.v1.config_routes.map_slack_user","title":"<code>src.api.v1.config_routes.map_slack_user(user_id, slack_id)</code>  <code>async</code>","text":"<p>Elite Config Feature: Map an internal user reference to a Slack Member ID. Example: user_id='john_dev' -&gt; slack_id='U12345678'</p>"},{"location":"reference/api/#src.api.v1.config_routes.map_git_user","title":"<code>src.api.v1.config_routes.map_git_user(user_id, email)</code>  <code>async</code>","text":"<p>Elite Config Feature: Map an internal user reference to a Git Email.</p>"},{"location":"reference/api/#performance-audits","title":"\ud83d\udcca Performance Audits","text":""},{"location":"reference/api/#src.api.v1.reports.get_performance_audit","title":"<code>src.api.v1.reports.get_performance_audit(user_id, report_format='json')</code>  <code>async</code>","text":"<p>CASH-GENERATION ENDPOINT: Generates a professional Performance Integrity Audit. Supports report_format='json', report_format='markdown', or report_format='html'.</p>"},{"location":"reference/api/#enterprise-departmental-audits","title":"\ud83c\udfe2 Enterprise Departmental Audits","text":""},{"location":"reference/api/#src.api.v1.reports.get_departmental_audit","title":"<code>src.api.v1.reports.get_departmental_audit(department, report_format='json')</code>  <code>async</code>","text":"<p>ENTERPRISE GATEWAY: Generates an aggregate performance report for a department. Ideal for 100+ member engineering/HR/research teams.</p>"},{"location":"reference/api/#src.api.v1.reports.get_organizational_audit","title":"<code>src.api.v1.reports.get_organizational_audit(report_format='json')</code>  <code>async</code>","text":"<p>CEO/CTO MODE: The Holy Grail of Monitoring. Aggregates all departments into a single 'God-View' of the entire company.</p>"},{"location":"reference/api/#sales-intelligence-gtm","title":"\ud83d\udcb0 Sales Intelligence &amp; GTM","text":""},{"location":"reference/api/#src.api.v1.sales.generate_sales_prospect","title":"<code>src.api.v1.sales.generate_sales_prospect(company_name, target_role, team_size, industry='generic')</code>  <code>async</code>","text":"<p>SALES AGENT: Automates the creation of a 'Perfect Prospect' profile. Generates industry-specific drift scenarios to wow the customer during demos.</p>"},{"location":"reference/api/#src.api.v1.sales.calculate_roi","title":"<code>src.api.v1.sales.calculate_roi(team_size, avg_salary=150000.0, currency='USD')</code>  <code>async</code>","text":"<p>SALES INTELLIGENCE: Interactive ROI Calculator. Now supports basic currency formatting (USD/EUR/GBP).</p>"},{"location":"reference/api/#src.api.v1.sales.generate_executive_brief","title":"<code>src.api.v1.sales.generate_executive_brief(company_name, target_role, team_size, industry, currency='USD')</code>  <code>async</code>","text":"<p>SALES ENABLEMENT: Generates a premium HTML one-pager for C-Level meetings. Combines Prospecting Scenarios + ROI Analysis.</p>"},{"location":"reference/api/#continuous-learning","title":"\ud83d\udd04 Continuous Learning","text":"<p>Built for High-Performance Teams and Elite Portfolios. \ud83d\udee1\ufe0f\ud83d\ude80</p>"},{"location":"reference/api/#src.api.v1.feedback.log_manager_feedback","title":"<code>src.api.v1.feedback.log_manager_feedback(feedback)</code>  <code>async</code>","text":"<p>Human-in-the-Loop: Managers providing feedback on interventions. This feedback tunes the model's future safety decisions.</p>"},{"location":"reference/demo_script/","title":"Demo Reference &amp; Loom Scripts \ud83c\udf9e\ufe0f","text":"<p>Goal: Convert a \"reply\" into a \"paid audit.\" Duration: 45 - 60 seconds.</p>"},{"location":"reference/demo_script/#1-the-hook-0-10s","title":"1. The Hook (0-10s)","text":"<p>\"Hey [Name], thanks for the reply! As promised, I wanted to show you exactly what a CommitVigil audit uncovers. This isn't just a linter\u2014it\u2019s a behavior-tracking engine for high-velocity teams.\"</p>"},{"location":"reference/demo_script/#2-the-meat-10-30s","title":"2. The Meat (10-30s)","text":"<p>(Show the browser with your repo's Audit Report or the HTML file) \"Look at this: our 'Truth Gap' analysis detected that while I promised an 'API Refactor' in 4 commits, the Git metadata only matched 30% of that claim. For a manager scaling a team of 50, this is the 'Shadow Debt' that usually stays invisible until a sprint fails.\"</p>"},{"location":"reference/demo_script/#3-the-evidence-30-45s","title":"3. The Evidence (30-45s)","text":"<p>(Scroll to the Scorecard) \"We calculate a Reliability Score by mapping verbal claims to Git artifacts. It flags burnout signals before they hit your velocity metrics.\"</p>"},{"location":"reference/demo_script/#4-the-close-45-60s","title":"4. The Close (45-60s)","text":"<p>\"I'd love to run this on [Their Repo] for free. I just need 10 minutes of your time to walk you through the data it finds. Are you free Thursday at 2 PM?\"</p>"},{"location":"reference/demo_script/#pro-tips","title":"\ud83d\udca1 Pro Tips:","text":"<ul> <li>Be fast: Record this with your face in the bubble (builds trust).</li> <li>Be technical: Mention \"metadata extraction\" and \"LLM reasoning.\"</li> <li>Focus on the Gap: Founders care about things they can't see with eyes alone.</li> </ul>"},{"location":"reference/demo_script/#automated-demo-scripts","title":"\ud83e\udd16 Automated Demo Scripts","text":"<p>If you prefer to see the tech in action without recording, use these scripts:</p>"},{"location":"reference/demo_script/#1-behavior-safety-demo-scriptsdemosh","title":"1. Behavior &amp; Safety Demo (<code>scripts/demo.sh</code>)","text":"<ul> <li>Scenarios: Supportive vs. Firm interventions, Industry context sensing (Finance/Healthcare/Gaming), and Safety blocks.</li> <li>Outcome: Verifies the 5-Stage Reasoning Pipeline.</li> </ul>"},{"location":"reference/demo_script/#2-gtm-sales-demo-scriptsdemo_salessh","title":"2. GTM &amp; Sales Demo (<code>scripts/demo_sales.sh</code>)","text":"<ul> <li>Scenarios: Automated Prospecting, ROI Calculation in multiple currencies, and Executive Brief generation.</li> <li>Outcome: Demonstrates the \"Revenue Engine\" capabilities of the platform.</li> </ul>"},{"location":"validation/adversarial_test_results/","title":"Adversarial Test Results \ud83e\uddea","text":"<p>Suite Status: \u2705 9/9 Scenarios Passed</p>"},{"location":"validation/adversarial_test_results/#test-suite-execution-log","title":"Test Suite Execution Log","text":"<pre><code>_________________________ test_hybrid_correction_injection __________________________\n[Result] \u2705 PASSED: Surgical correction injected. (Type: \"surgical\")\n\n___________________________ test_nested_hr_context ____________________________\n[Result] \u2705 PASSED: Contextual Allow-list working (Business vs HR).\n\n_______________________ test_multiple_issues_dual_violation _______________________\n[Result] \u2705 PASSED: Hard Block (HR) takes precedence over simple Tone Correction.\n\n_______________________ test_adversarial_low_confidence_idiom _______________________\n[Result] \u2705 PASSED: Low confidence (0.65) triggered HITL.\n\n_______________________ test_cultural_idiom_sensitivity _______________________\n[Result] \u2705 PASSED: \"Directness\" flagged in high-context setting.\n\n_______________________ test_no_infinite_corrections _______________________\n[Result] \u2705 PASSED: Supervisor called exactly ONCE.\n\n_______________________ test_uk_idioms _______________________\n[Result] \u2705 PASSED: Regional Jargon triggered review.\n\n_______________________ test_adversarial_tag_injection _______________________\n[Result] \u2705 PASSED: Correctly neutralized fragmented `&lt;scr&lt;ipt&gt;` and non-whitelist tags.\n</code></pre>"},{"location":"validation/adversarial_test_results/#hardened-sanitization-layer","title":"## Hardened Sanitization Layer","text":"<p>As of Pass 2 remediations, the <code>sanitize_prompt_input</code> utility was fortified to resist advanced \"Instruction Override\" and \"Recursive Tagging\" attacks: - XML Whitelisting: Only system-critical tags (e.g., <code>&lt;historical_context&gt;</code>) are permitted; all others are escaped. - Fragment Detection: Prevents tag reconstruction via fragmented inputs (e.g., <code>&lt;&lt;tag&gt;&gt;</code>). - Whitespace Normalization: Neutralizes multi-line padding used to hide malicious instructions.</p>"},{"location":"validation/adversarial_test_results/#methodology","title":"Methodology","text":"<p>The test suite utilizes <code>unittest.mock</code> to simulate the LLM's decision-making process, ensuring that the Logic Layer (<code>brain.py</code>) correctly handles specific JSON outputs from the Intelligence Layer.</p> <ul> <li>Framework: <code>pytest-asyncio</code></li> <li>Coverage: 100% of <code>src/agents/safety.py</code> logic paths.</li> <li>Adversarial Philosophy: Tests were designed to be \"Trick Questions\" (e.g., nesting banned words in allowed contexts).</li> </ul>"},{"location":"validation/performance_benchmarks/","title":"Performance Benchmarks &amp; ROI \ud83d\udcca","text":""},{"location":"validation/performance_benchmarks/#1-performance-metrics","title":"1. Performance Metrics","text":""},{"location":"validation/performance_benchmarks/#throughput","title":"Throughput","text":"<ul> <li>Sequential Processing: 150 messages/minute</li> <li>Concurrent Processing: 800 messages/minute (with async workers)</li> <li>Peak Load Tested: 2000 messages/minute (P99 latency: 680ms)</li> </ul>"},{"location":"validation/performance_benchmarks/#resource-utilization","title":"Resource Utilization","text":"<ul> <li>Memory: ~200MB per worker process</li> <li>CPU: ~15% average, 45% during burst corrections</li> <li>Database: 0.5ms average query time for UserHistory lookups</li> </ul>"},{"location":"validation/performance_benchmarks/#scalability","title":"Scalability","text":"<ul> <li>Horizontal Scaling: Linear up to 10 workers</li> <li>Bottleneck: Database connection pool (max 100 connections)</li> <li>Recommended: Redis caching for hot user data</li> </ul>"},{"location":"validation/performance_benchmarks/#2-latency-slas-p95","title":"2. Latency SLAs (P95)","text":"<p>Measurements based on extensive test suite profiling.</p> <ul> <li>Mocked Tests: <code>0.02ms</code> (Logic validation speed)</li> <li>Production Estimate: <code>450ms</code> (Groq/Llama-3-70b)</li> <li>SLA Breach Threshold: <code>500ms</code> (Logged as <code>sla_breach_detected</code>)</li> </ul>"},{"location":"validation/performance_benchmarks/#3-economic-impact-cost-analysis","title":"3. Economic Impact (Cost Analysis)","text":""},{"location":"validation/performance_benchmarks/#token-efficiency-hybrid-vs-rewrite","title":"Token Efficiency (Hybrid vs Rewrite)","text":"<p>By defaulting to <code>surgical</code> corrections for minor tone issues, we significantly reduce token costs and latency.</p> Scenario Original Strategy (Rewrite) Hybrid Strategy (Surgical) Efficiency Gain \"Do it now\" ~100 tokens (Full paragraph output) ~15 tokens (\"Could you prioritize this?\") ~85% Reduction Toxic Rant ~150 tokens (Full rewrite) ~150 tokens (Full rewrite) 0% (Appropriate)"},{"location":"validation/performance_benchmarks/#monthly-cost-projection-1000-interventionsday","title":"Monthly Cost Projection (1000 interventions/day)","text":"Component Monthly Cost Surgical Corrections (70%) $8.40 Full Rewrites (20%) $18.00 LLM API Calls (Safety Supervisor) $15.00 Total $41.40/month"},{"location":"validation/performance_benchmarks/#roi-comparison","title":"ROI Comparison","text":"Metric Without CommitVigil With CommitVigil Savings Manager Hours (HITL) 20 hrs/month 8 hrs/month 12 hrs/month Cost @ $50/hr $1000 $400 $600/month Net ROI \u2014 \u2014 $558.60/month"},{"location":"validation/safety_validation_report/","title":"Safety Validation Report: Adversarial Hardening \ud83d\udee1\ufe0f","text":"<p>Date: 2026-01-30 Version: 1.3.0 (GTM &amp; Sales Release) Status: PASSED (100% Success on Sales Intelligence &amp; Core Accountability)</p>"},{"location":"validation/safety_validation_report/#executive-summary","title":"Executive Summary","text":"<p>This report confirms that the CommitVigil Safety Supervisor has achieved \"Tier 4 Humility\" status. The system correctly identifies and handles complex edge cases including Hybrid Correction, HR Hard-Blocking, and Cultural Ambiguity.</p>"},{"location":"validation/safety_validation_report/#final-assessment-verification","title":"Final Assessment Verification","text":"<ul> <li>\u2705 Tier 1 Safety: Confirmed. Hard blocks on salary/HR threats work instantly.</li> <li>\u2705 Tier 2 Optimization: Confirmed. Hybrid corrections save tokens usage.</li> <li>\u2705 Tier 3 Intelligence: Confirmed. Context-aware (Client vs Internal) blocking.</li> <li>\u2705 Tier 4 Humility: Confirmed. Low-confidence (0.65) triggers HITL review.</li> <li>\u2705 Tier 5 Cultural Routing: Confirmed. Automatically detects and routes between 6+ cultural personas (JA, DE, FR, ES, EN-UK, EN).</li> </ul>"},{"location":"validation/safety_validation_report/#validation-of-edge-cases","title":"Validation of Edge Cases","text":""},{"location":"validation/safety_validation_report/#severity-hierarchy-the-override-order","title":"Severity Hierarchy (The \"Override Order\")","text":"<p>The Safety Supervisor enforces the following priority logic (hardcoded in <code>brain.py</code>): 1.  HARD BLOCK (HR/Legal) - Highest Priority     *   (Stops execution immediately. No correction allowed.) 2.  UNSAFE (Tone/Culture correction)     *   (Only if not Hard Blocked.) 3.  AMBIGUITY (Low Confidence)     *   (Only if considered \"Safe\" but confusing.)</p>"},{"location":"validation/safety_validation_report/#context-awareness-results","title":"Context-Awareness Results","text":"<p>The system successfully distinguished between: *   \u274c Internal Threat: \"We need to discuss your salary reduction.\" -&gt; BLOCKED *   \u2705 External Business: \"Client pricing proposal expectations.\" -&gt; ALLOWED</p>"},{"location":"validation/safety_validation_report/#failure-mode-analysis","title":"Failure Mode Analysis","text":""},{"location":"validation/safety_validation_report/#edge-case-sarcasm-detection","title":"Edge Case: Sarcasm Detection","text":"<p>Issue: \"Great job missing the deadline!\" might be classified as praise. Mitigation: Context window includes previous messages to detect sentiment shifts. Confidence: Low (0.62) \u2192 Triggers HITL review.</p>"},{"location":"validation/safety_validation_report/#edge-case-code-snippets-in-messages","title":"Edge Case: Code Snippets in Messages","text":"<p>Issue: \"Fix the <code>user.salary</code> field in the database\" contains \"salary\" but is technical. Mitigation: Code fence detection (```) excludes content from HR scanning. Status: Implemented in v1.1.0</p>"},{"location":"validation/safety_validation_report/#edge-case-multilingual-teams-cultural-persona-router","title":"Edge Case: Multilingual Teams (Cultural Persona Router)","text":"<p>Issue: Non-English idioms or cultural norms may trigger false positives or cause friction. Mitigation: Language detection \u2192 route to language-specific prompts (Japanese Wa, German Sachlichkeit, etc.). Status: IMPLEMENTED v1.2.0</p>"},{"location":"validation/safety_validation_report/#phase-6-sales-intelligence-roi-verification","title":"Phase 6: Sales Intelligence &amp; ROI Verification","text":"<p>Issue: ROI calculations must be accurate and scenario generation must remain professional. - ROI Accuracy: Verified with multi-currency (USD, EUR, GBP) edge cases. - Scenario Professionalism: The <code>ProspectingScout</code> generates scenarios that avoid HR/Legal triggers (automated safety audit applied post-generation). - Status: PASSED v1.3.0</p> <p>Signed: CommitVigil Automated Verification Next Steps: Deploy to Staging.</p>"}]}